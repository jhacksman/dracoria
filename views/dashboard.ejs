<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('partials/_head.ejs') %>
    <title>Dashboard</title>
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
  <%- include('partials/_header.ejs') %>

    <div class="container mt-4">
      <h1>Dashboard</h1>
      <div id="dragonStatus">
        <!-- Dragon status will be loaded here -->
      </div>
      <div id="gardenStatus">
        <!-- Garden status will be loaded here -->
        <div id="fruitCount">Fruit Count: 0</div>
      </div>
      <div id="buttons">
        <button id="giveJuiceBtn">Give Juice</button> <!-- Added this line -->
        <button id="pickFruitBtn">Pick Fruit</button>
      </div>
      <div id="lavaJuiceBalance">Lava Juice Balance: 0</div>
      <div id="dragonExperience">Dragon Experience: 0</div>
      <div id="dragonEnergy">Dragon Energy: 100</div>
    </div>

    <%- include('partials/_footer.ejs') %>
      <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
      <script src="/js/dashboard.js"></script>
      <script>
        document.getElementById('pickFruitBtn').addEventListener('click', function () {
          axios.post('/api/garden/pick-fruit')
            .then(function (response) {
              console.log('Fruit picked successfully', response);
              // Update UI based on response
              const fruitCountDisplay = document.getElementById('fruitCount');
              const lavaJuiceBalanceDisplay = document.getElementById('lavaJuiceBalance');
              if (fruitCountDisplay) {
                fruitCountDisplay.textContent = `Fruit Count: ${response.data.fruitCount}`;
              }
              if (lavaJuiceBalanceDisplay) {
                lavaJuiceBalanceDisplay.textContent = `Lava Juice Balance: ${response.data.lavaJuiceBalance}`;
              }
            })
            .catch(function (error) {
              console.error('Error picking fruit:', error.response ? error.response.data : error);
            });
        });

        document.getElementById('giveJuiceBtn').addEventListener('click', function () {
          axios.post('/api/dragon/give-juice')
            .then(function (response) {
              console.log('Juice given successfully', response);
              // Update UI based on response
              const dragonExperienceDisplay = document.getElementById('dragonExperience');
              const dragonEnergyDisplay = document.getElementById('dragonEnergy');
              if (dragonExperienceDisplay) {
                dragonExperienceDisplay.textContent = `Dragon Experience: ${response.data.experience}`;
              }
              if (dragonEnergyDisplay) {
                dragonEnergyDisplay.textContent = `Dragon Energy: ${response.data.energy}`;
              }
            })
            .catch(function (error) {
              console.error('Error giving juice:', error.response ? error.response.data : error);
            });
        });
      </script>
</body>

</html>
<!DOCTYPE html>
<html lang="en">
<%- include('partials/_head.ejs') %>
<body>
<%- include('partials/_header.ejs') %>

<div class="container mt-5">
    <h2>Your Dragon</h2>
    <div id="dragon-status">
        <p><strong>Stage:</strong> <%= dragon.stage %></p>
        <p><strong>Hunger:</strong> <%= dragon.hunger %></p>
        <p><strong>Happiness:</strong> <%= dragon.happiness %></p>
    </div>
    <div id="chat-with-dragon">
        <h4>Chat with your dragon:</h4>
        <textarea id="dragon-chat-input" class="form-control" placeholder="Say something..."></textarea>
        <button id="send-chat" class="btn btn-primary mt-2">Send</button>
    </div>
</div>

<%- include('partials/_footer.ejs') %>
<script src="/js/dragonInteraction.js"></script>
<script>
document.getElementById('send-chat').addEventListener('click', function() {
    const input = document.getElementById('dragon-chat-input');
    const message = input.value;
    fetch('/api/dragon/chat', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({message: message}),
    })
    .then(response => response.json())
    .then(data => {
        console.log('Chat message sent:', message);
        input.value = ''; // Clear input after sending
    })
    .catch((error) => {
        console.error('Error sending chat message:', error);
    });
});
</script>
</body>
</html>
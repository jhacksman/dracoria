<!DOCTYPE html>
<html lang="en">
<%- include('partials/_head.ejs') %>
<body>
<%- include('partials/_header.ejs') %>

<div class="container mt-5">
    <h2>Your Garden</h2>
    <div id="garden-status">
        <p><strong>Tree Type:</strong> <%= garden.treeType %></p>
        <p><strong>Fruit Count:</strong> <%= garden.fruitCount %></p>
        <p><strong>Last Harvested:</strong> <%= garden.lastHarvested.toDateString() %></p>
    </div>
    <button id="harvest-fruit" class="btn btn-success mt-2">Harvest Fruit</button>
</div>

<%- include('partials/_footer.ejs') %>
<script src="/js/gardenManagement.js"></script>
<script>
document.getElementById('harvest-fruit').addEventListener('click', function() {
    fetch('/api/garden/harvest', {
        method: 'POST',
    })
    .then(response => response.json())
    .then(data => {
        console.log('Harvest success:', data);
        document.getElementById('garden-status').innerHTML = `<p><strong>Tree Type:</strong> ${data.garden.treeType}</p>
        <p><strong>Fruit Count:</strong> ${data.garden.fruitCount}</p>
        <p><strong>Last Harvested:</strong> ${new Date(data.garden.lastHarvested).toDateString()}</p>`;
    })
    .catch((error) => {
        console.error('Error harvesting fruit:', error);
        alert('Error harvesting fruit. Please try again.');
    });
});
</script>
</body>
</html>